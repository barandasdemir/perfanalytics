!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";
// Copyright (C) 2021 Baran Dasdemir

// This file is part of perfanalytics.

// perfanalytics is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// perfanalytics is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with perfanalytics.  If not, see <http://www.gnu.org/licenses/>.
const e={isAPIAvailable:()=>!!(window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByName&&navigator&&"function"==typeof navigator.sendBeacon&&"function"==typeof fetch),siteID:null,ttfb:null,fcp:null,domLoad:null,windowLoad:null,resources:[]},n="https://barandasdemir-perfanalytics.herokuapp.com",t=e=>e/1e3;if(e.isAPIAvailable()){const{timing:o}=window.performance.toJSON();fetch(`${n}/website/register`,{method:"POST",body:JSON.stringify({origin:window.location.origin}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((n=>{e.siteID=n.data.id;const[i]=window.performance.getEntriesByName("first-contentful-paint");e.fcp=t(i.startTime),e.ttfb=t(o.responseStart-o.requestStart),e.domLoad=t(o.domContentLoadedEventEnd-o.navigationStart),e.windowLoad=t(Date.now()-o.navigationStart);const a=window.performance.getEntriesByType("resource");e.resources=a.filter((e=>"fetch"!==e.initiatorType)).map((e=>({name:e.name,duration:t(e.responseEnd-e.requestStart),size:e.decodedBodySize})))})),window.onload=()=>{navigator.sendBeacon(`${n}/analytic/${e.siteID}`,JSON.stringify(e))}}}));
